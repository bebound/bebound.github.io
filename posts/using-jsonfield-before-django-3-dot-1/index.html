<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=color-scheme content="light dark"><meta name=author content="KK"><meta name=description content="In Django 3.1, Django support save python data into database as JSON encoded data and it is also possible to make query based on field value in JSONField. The detailed usage can be found here. If you are using older version and want to try this feature. Though there are many packages ported this function, I recommend django-jsonfield-backport.
django-jsonfield-backport This package save data as JSON in database and also support JSON query."><meta name=keywords content="fromkk,blog,kk blog,developer,personal,python,golang,go,linux,machine learning"><meta name=twitter:card content="summary"><meta name=twitter:title content="Using JSONField before Django 3.1"><meta name=twitter:description content="In Django 3.1, Django support save python data into database as JSON encoded data and it is also possible to make query based on field value in JSONField. The detailed usage can be found here. If you are using older version and want to try this feature. Though there are many packages ported this function, I recommend django-jsonfield-backport.
django-jsonfield-backport This package save data as JSON in database and also support JSON query."><meta property="og:title" content="Using JSONField before Django 3.1"><meta property="og:description" content="In Django 3.1, Django support save python data into database as JSON encoded data and it is also possible to make query based on field value in JSONField. The detailed usage can be found here. If you are using older version and want to try this feature. Though there are many packages ported this function, I recommend django-jsonfield-backport.
django-jsonfield-backport This package save data as JSON in database and also support JSON query."><meta property="og:type" content="article"><meta property="og:url" content="https://www.fromkk.com/posts/using-jsonfield-before-django-3-dot-1/"><meta property="article:published_time" content="2021-09-11T21:12:00+08:00"><meta property="article:modified_time" content="2021-09-11T21:15:12+08:00"><title>Using JSONField before Django 3.1 · KK's Blog (fromkk)</title><link rel=canonical href=https://www.fromkk.com/posts/using-jsonfield-before-django-3-dot-1/><link rel=preload href="https://www.fromkk.com/fonts/forkawesome-webfont.woff2?v=1.1.7" as=font type=font/woff2 integrity="sha256-hEIt6X6xzye8ubyk8/uxjz68cRZHsJxoKS9fQ8idUGQ=" crossorigin><link rel=stylesheet href=https://www.fromkk.com/css/coder.min.ec198d25949ddd79a670b1ead43ca88e0bc2c1343266d0df0a9eeb7f3f207777.css integrity="sha256-7BmNJZSd3XmmcLHq1DyojgvCwTQyZtDfCp7rfz8gd3c=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://www.fromkk.com/css/coder-dark.min.89c82b6022b96f77aeb521b240daec4f87ea029d84d1c78b8acd0735b91b3c92.css integrity="sha256-icgrYCK5b3eutSGyQNrsT4fqAp2E0ceLis0HNbkbPJI=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=https://www.fromkk.com/icons/icon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://www.fromkk.com/icons/icon-16x16.png sizes=16x16><link rel=apple-touch-icon href=https://www.fromkk.com/icons/icon-192x192.png><link rel=apple-touch-icon sizes=180x180 href=https://www.fromkk.com/icons/icon-192x192.png><meta name=generator content="Hugo 0.68.3"></head><body class=colorscheme-auto><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://www.fromkk.com/>KK's Blog (fromkk)</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://www.fromkk.com/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://www.fromkk.com/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=https://www.fromkk.com/about/>About</a></li><li class=navigation-item><a class=navigation-link href=https://www.fromkk.com/posts/index.xml>RSS</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.fromkk.com/posts/using-jsonfield-before-django-3-dot-1/>Using JSONField before Django 3.1</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i><time datetime=2021-09-11T21:12:00+08:00>09/11/2021</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>2-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i><a href=https://www.fromkk.com/tags/python/>Python</a>
<span class=separator>•</span>
<a href=https://www.fromkk.com/tags/django/>Django</a></div></div></header><div><p>In Django 3.1, Django support save python data into database as JSON encoded data and it is also possible to make query based on field value in JSONField. The detailed usage can be found <a href=https://docs.djangoproject.com/en/3.2/topics/db/queries/#querying-jsonfield>here</a>. If you are using older version and want to try this feature. Though there are many packages ported this function, I recommend <a href=https://github.com/laymonage/django-jsonfield-backport>django-jsonfield-backport</a>.</p><h2 id=django-jsonfield-backport>django-jsonfield-backport</h2><p>This package save data as JSON in database and also support JSON query. If your database meet the requirements (MySQL > 5.7, PG > 9.5, MariaDB > 10.2 or SQLite > 3.9 with <a href=https://docs.djangoproject.com/en/3.1/ref/databases/#sqlite-json1>JSON1</a> extension), you can use JSONField like Django&rsquo;s native implementation.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#f92672>from</span> django.db <span style=color:#66d9ef>import</span> models
<span style=color:#f92672>from</span> django_jsonfield_backport.models <span style=color:#66d9ef>import</span> JSONField

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ContactInfo</span>(models<span style=color:#f92672>.</span>Model):
    data <span style=color:#f92672>=</span> JSONField()

ContactInfo<span style=color:#f92672>.</span>objects<span style=color:#f92672>.</span>create(data<span style=color:#f92672>=</span>{
    <span style=color:#e6db74>&#39;name&#39;</span>: <span style=color:#e6db74>&#39;John&#39;</span>,
    <span style=color:#e6db74>&#39;cities&#39;</span>: [<span style=color:#e6db74>&#39;London&#39;</span>, <span style=color:#e6db74>&#39;Cambridge&#39;</span>],
    <span style=color:#e6db74>&#39;pets&#39;</span>: {<span style=color:#e6db74>&#39;dogs&#39;</span>: [<span style=color:#e6db74>&#39;Rufus&#39;</span>, <span style=color:#e6db74>&#39;Meg&#39;</span>]},
})
ContactInfo<span style=color:#f92672>.</span>objects<span style=color:#f92672>.</span>filter(
    data__name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;John&#39;</span>,
    data__pets__has_key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;dogs&#39;</span>,
    data__cities__contains<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;London&#39;</span>,
)<span style=color:#f92672>.</span>delete()
</code></pre></div><h2 id=jsonfield>jsonfield</h2><p><a href=https://github.com/rpkilby/jsonfield>jsonfield</a> is another popular package to use JSONField. It will save data as <code>Text</code> in database, but you can manipulate field value as python data. In addition, it does not provide JSON querying capability as <code>django-jsonfield-backport</code>.</p><h3 id=django-rest-framework>Django REST framework</h3><p>As data is stored as JSON string in database, the output is string rather than object when Django DRF serialize <code>jsonfield.JSONField</code>. If you prefer to get and update the data like object, you need to manually specify it as `serializer.JSONField` like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=color:#f92672>from</span> rest_framework <span style=color:#66d9ef>import</span> serializers
<span style=color:#f92672>from</span> .models <span style=color:#66d9ef>import</span> Product

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ProductSerializer</span>(serializers<span style=color:#f92672>.</span>ModelSerializer):
    images <span style=color:#f92672>=</span> serializers<span style=color:#f92672>.</span>JSONField()
    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Meta</span>:
        model <span style=color:#f92672>=</span> Product
        fields <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;__all__&#39;</span>
</code></pre></div><p>(You do not need to do this when using <code>django-jsonfield-backport</code>, everything just works.)</p><h2 id=ref>Ref:</h2><ol><li><a href=https://github.com/laymonage/django-jsonfield-backport>GitHub - django-jsonfield-backport</a></li><li><a href=https://librenepal.com/article/use-jsonfield-with-django-rest-framework/>Use JSONField with Django Rest Framework</a></li><li><a href=https://www.geeksforgeeks.org/jsonfield-in-serializers-django-rest-framework/>JSONField in serializers – Django REST Framework</a></li><li><a href=https://www.django-rest-framework.org/api-guide/fields/#jsonfield>Django REST framework - jsonfield</a></li></ol></div><footer><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"kkblog-1"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}};</script></section></div><footer class=footer><section class=container>©
2021
KK
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=https://www.fromkk.com/js/dark-mode.min.0213e1773e6d1c5a644f847c67a6f8abac49a3776e2976f6008038af8c5b76a1.js integrity="sha256-AhPhdz5tHFpkT4R8Z6b4q6xJo3duKXb2AIA4r4xbdqE="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-153788833-1','auto');ga('send','pageview');}</script></body></html>