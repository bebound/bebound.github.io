<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=author content="KK"><meta name=description content="Recently, I enjoy using Spacemacs, so I decided to switch to org file from Markdown for writing blog. After several attempts, I managed to let Travis convert org file to HTML. Here are the steps.
Install Org Mode plugin First you need to install Org Mode plugin on your computer following the official guide: Nikola orgmode plugin.
Edit conf.el Org Mode will convert to HTML to display on Nikola. Org Mode plugin will call Emacs to do this job."><meta name=keywords content="fromkk,blog,kk blog,developer,personal,python,golang,go,linux,machine learning"><meta name=twitter:card content="summary"><meta name=twitter:title content="Deploy Nikola Org Mode on Travis"><meta name=twitter:description content="Recently, I enjoy using Spacemacs, so I decided to switch to org file from Markdown for writing blog. After several attempts, I managed to let Travis convert org file to HTML. Here are the steps.
Install Org Mode plugin First you need to install Org Mode plugin on your computer following the official guide: Nikola orgmode plugin.
Edit conf.el Org Mode will convert to HTML to display on Nikola. Org Mode plugin will call Emacs to do this job."><meta property="og:title" content="Deploy Nikola Org Mode on Travis"><meta property="og:description" content="Recently, I enjoy using Spacemacs, so I decided to switch to org file from Markdown for writing blog. After several attempts, I managed to let Travis convert org file to HTML. Here are the steps.
Install Org Mode plugin First you need to install Org Mode plugin on your computer following the official guide: Nikola orgmode plugin.
Edit conf.el Org Mode will convert to HTML to display on Nikola. Org Mode plugin will call Emacs to do this job."><meta property="og:type" content="article"><meta property="og:url" content="https://www.fromkk.com/posts/deploy-nikola-org-mode-on-travis/"><meta property="article:published_time" content="2018-11-03T21:20:00+08:00"><meta property="article:modified_time" content="2020-03-26T00:40:06+08:00"><base href=https://www.fromkk.com/posts/deploy-nikola-org-mode-on-travis/><title>Deploy Nikola Org Mode on Travis · KK's Blog (fromkk)</title><link rel=canonical href=https://www.fromkk.com/posts/deploy-nikola-org-mode-on-travis/><link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.13.0/css/all.css integrity=sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=https://www.fromkk.com/css/coder.min.fce3d3684e836ce340cdd591dad1749c310472d5ed4049fab99845c9aec4d4bf.css integrity="sha256-/OPTaE6DbONAzdWR2tF0nDEEctXtQEn6uZhFya7E1L8=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://www.fromkk.com/css/custom.css><link rel=icon type=image/png href=https://www.fromkk.com/icons/icon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://www.fromkk.com/icons/icon-16x16.png sizes=16x16><link rel=apple-touch-icon href=https://www.fromkk.com/icons/icon-192x192.png><link rel=apple-touch-icon sizes=180x180 href=https://www.fromkk.com/icons/icon-192x192.png><meta name=generator content="Hugo 0.68.3"></head><body class=colorscheme-light><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://www.fromkk.com/>KK's Blog (fromkk)</a>
<span id=dark-mode-toggle class=float-right><i class="fas fa-adjust fa-fw"></i></span><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fas fa-bars fa-fw"></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://www.fromkk.com/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://www.fromkk.com/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=https://www.fromkk.com/about/>About</a></li><li class=navigation-item><a class=navigation-link href=https://www.fromkk.com/posts/index.xml>RSS</a></li><li class="navigation-item separator"><span>|</span></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title>Deploy Nikola Org Mode on Travis</h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fas fa-calendar"></i><time datetime=2018-11-03T21:20:00+08:00>11/03/2018</time></span>
<span class=reading-time><i class="fas fa-clock"></i>3-minute read</span></div><div class=tags><i class="fas fa-tag"></i><a href=https://www.fromkk.com/tags/python/>Python</a>
<span class=separator>•</span>
<a href=https://www.fromkk.com/tags/nikola/>Nikola</a>
<span class=separator>•</span>
<a href=https://www.fromkk.com/tags/org-mode/>Org Mode</a></div></div></header><div><p>Recently, I enjoy using <code>Spacemacs</code>, so I decided to switch to org file from Markdown for writing blog. After several attempts, I managed to let Travis convert org file to HTML. Here are the steps.</p><h2 id=install-org-mode-plugin>Install Org Mode plugin</h2><p>First you need to install Org Mode plugin on your computer following the official guide: <a href=https://plugins.getnikola.com/v8/orgmode/>Nikola orgmode plugin</a>.</p><h2 id=edit-conf-dot-el>Edit <code>conf.el</code></h2><p><code>Org Mode</code> will convert to HTML to display on Nikola. Org Mode plugin will call Emacs to do this job. When I run <code>nikola build</code>, it shows this message: <code>Please install htmlize from https://github.com/hniksic/emacs-htmlize</code>. I&rsquo;m using <code>Spacemacs</code>, the <code>htmlize</code> package is already downloaded if the <code>org</code> layer is enabled. I just need to add htmlize folder to load-path. So here is the code:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elisp data-lang=elisp>(setq dir <span style=color:#e6db74>&#34;~/.emacs.d/elpa/27.0/develop/&#34;</span>)
(if(<span style=color:#a6e22e>file-directory-p</span> dir)
    (let ((default-directory dir))
      (normal-top-level-add-subdirs-to-load-path)))
(require <span style=color:#e6db74>&#39;htmlize</span>)
</code></pre></div><p>This package is also needed on Travis, the similar approach is required.</p><h2 id=modify-dot-travis-dot-yml>Modify <code>.travis.yml</code></h2><p>Travis is using ubuntu 14.04, and the default Emacs version is 24, and the Org Mode version is below 8.0, which not match the requirements. The easiest solution is to update Emacs to 25. So in the <code>before_install</code> section, add these code:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- sudo add-apt-repository ppa:kelleyk/emacs -y
- sudo apt-get update
</code></pre></div><p>In the <code>install</code> section, add these code:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- sudo apt-get remove emacs
- sudo apt autoremove
- sudo apt-get install emacs25
</code></pre></div><p>The default emacs doesn&rsquo;t contains <code>htmlize</code> package. So add <code>git clone https://github.com/hniksic/emacs-htmlize ~/emacs-htmlize</code> into <code>before_install</code> section.</p><p>Finally, modify <code>conf.el</code> for Travis Emacs, add GitHub repo to <code>load-path</code>: <code>(add-to-list 'load-path "~/emacs-htmlize/")</code></p><p>Voila, the org file should show up.</p><p>The full <code>.travis.yml</code> is below:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>language</span>: python
<span style=color:#66d9ef>cache</span>: apt
<span style=color:#66d9ef>sudo</span>: <span style=color:#66d9ef>false</span>
<span style=color:#66d9ef>addons</span>:
  <span style=color:#66d9ef>apt</span>:
    <span style=color:#66d9ef>packages</span>:
    - language-pack-en-base
<span style=color:#66d9ef>branches</span>:
  <span style=color:#66d9ef>only</span>:
  - src
<span style=color:#66d9ef>python</span>:
- <span style=color:#ae81ff>3.6</span>
<span style=color:#66d9ef>before_install</span>:
- sudo add-apt-repository ppa:kelleyk/emacs -y
- sudo apt-get update
- openssl aes<span style=color:#ae81ff>-256</span>-cbc -K $encrypted_a5c638e4bedc_key -iv $encrypted_a5c638e4bedc_iv
  -in travis.enc -out travis -d
- git config --global user.name <span style=color:#e6db74>&#39;bebound&#39;</span>
- git config --global user.email <span style=color:#e6db74>&#39;bebound@gmail.com&#39;</span>
- git config --global push.default <span style=color:#e6db74>&#39;simple&#39;</span>
- pip install --upgrade pip wheel
- echo -e <span style=color:#e6db74>&#39;Host github.com\n    StrictHostKeyChecking no&#39;</span> &gt;&gt; ~/.ssh/config
- eval <span style=color:#e6db74>&#34;$(ssh-agent -s)&#34;</span>
- chmod <span style=color:#ae81ff>600</span> travis
- ssh-add travis
- git remote rm origin
- git remote add origin git@github.com:bebound/bebound.github.io
- git fetch origin master
- git branch master FETCH_HEAD
- git clone https://github.com/hniksic/emacs-htmlize ~/emacs-htmlize
<span style=color:#66d9ef>install</span>:
- pip install <span style=color:#e6db74>&#39;Nikola[extras]&#39;</span>==<span style=color:#ae81ff>7.8.15</span>
- sudo apt-get remove emacs
- sudo apt autoremove
- sudo apt-get install emacs25
<span style=color:#66d9ef>script</span>:
- nikola build <span style=color:#75715e>&amp;&amp;</span> nikola github_deploy -m <span style=color:#e6db74>&#39;Nikola auto deploy [ci skip]&#39;</span>
<span style=color:#66d9ef>notifications</span>:
  <span style=color:#66d9ef>email</span>:
    <span style=color:#66d9ef>on_success</span>: change
    <span style=color:#66d9ef>on_failure</span>: always
</code></pre></div><p>And here is the <code>conf.el</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elisp data-lang=elisp>(setq dir <span style=color:#e6db74>&#34;~/.emacs.d/elpa/27.0/develop/&#34;</span>)
(if(<span style=color:#a6e22e>file-directory-p</span> dir)
    (let ((default-directory dir))
      (normal-top-level-add-subdirs-to-load-path)))
(add-to-list <span style=color:#e6db74>&#39;load-path</span> <span style=color:#e6db74>&#34;~/emacs-htmlize/&#34;</span>)
(require <span style=color:#e6db74>&#39;htmlize</span>)
</code></pre></div></div><footer><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"kkblog-1"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js id=MathJax-script></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}};</script></section></div><footer class=footer><section class=container>©
2020
KK
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=https://www.fromkk.com/js/dark-mode.min.0213e1773e6d1c5a644f847c67a6f8abac49a3776e2976f6008038af8c5b76a1.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-153788833-1','auto');ga('send','pageview');}</script></body></html>