<!doctype html><html lang=en><head><title>Deploy Nikola Org Mode on Travis · KK's Blog (fromkk)
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="KK"><meta name=description content="Recently, I enjoy using Spacemacs, so I decided to switch to org file from Markdown for writing blog. After several attempts, I managed to let Travis convert org file to HTML. Here are the steps.
Install Org Mode plugin Link to heading First you need to install Org Mode plugin on your computer following the official guide: Nikola orgmode plugin.
Edit conf.el Link to heading Org Mode will convert to HTML to display on Nikola."><meta name=keywords content="fromkk,blog,kk blog,developer,personal,python,golang,go,linux,machine learning"><meta name=twitter:card content="summary"><meta name=twitter:title content="Deploy Nikola Org Mode on Travis"><meta name=twitter:description content="Recently, I enjoy using Spacemacs, so I decided to switch to org file from Markdown for writing blog. After several attempts, I managed to let Travis convert org file to HTML. Here are the steps.
Install Org Mode plugin Link to heading First you need to install Org Mode plugin on your computer following the official guide: Nikola orgmode plugin.
Edit conf.el Link to heading Org Mode will convert to HTML to display on Nikola."><meta property="og:title" content="Deploy Nikola Org Mode on Travis"><meta property="og:description" content="Recently, I enjoy using Spacemacs, so I decided to switch to org file from Markdown for writing blog. After several attempts, I managed to let Travis convert org file to HTML. Here are the steps.
Install Org Mode plugin Link to heading First you need to install Org Mode plugin on your computer following the official guide: Nikola orgmode plugin.
Edit conf.el Link to heading Org Mode will convert to HTML to display on Nikola."><meta property="og:type" content="article"><meta property="og:url" content="https://www.fromkk.com/posts/deploy-nikola-org-mode-on-travis/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-11-03T21:20:00+08:00"><meta property="article:modified_time" content="2020-03-26T00:40:06+08:00"><link rel=canonical href=https://www.fromkk.com/posts/deploy-nikola-org-mode-on-travis/><link rel=preload href="https://www.fromkk.com/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=https://www.fromkk.com/css/coder.min.ea4c355c5f9913809f506132a80bf3fab84f2679dee370f334f7385a36d24c38.css integrity="sha256-6kw1XF+ZE4CfUGEyqAvz+rhPJnne43DzNPc4WjbSTDg=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://www.fromkk.com/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=https://www.fromkk.com/images/favicon.svg sizes=any><link rel=icon type=image/png href=https://www.fromkk.com/icons/icon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://www.fromkk.com/icons/icon-16x16.png sizes=16x16><link rel=apple-touch-icon href=https://www.fromkk.com/icons/icon-192x192.png><link rel=apple-touch-icon sizes=180x180 href=https://www.fromkk.com/icons/icon-192x192.png><link rel=manifest href=https://www.fromkk.com/site.webmanifest><link rel=mask-icon href=https://www.fromkk.com/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://www.fromkk.com/>KK's Blog (fromkk)
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://www.fromkk.com/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://www.fromkk.com/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=https://www.fromkk.com/about/>About</a></li><li class=navigation-item><a class=navigation-link href=https://www.fromkk.com/posts/index.xml>RSS</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.fromkk.com/posts/deploy-nikola-org-mode-on-travis/>Deploy Nikola Org Mode on Travis</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2018-11-03T21:20:00+08:00>11/03/2018
</time></span><span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
3-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=https://www.fromkk.com/tags/python/>Python</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://www.fromkk.com/tags/nikola/>Nikola</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://www.fromkk.com/tags/org-mode/>Org Mode</a></span></div></div></header><div class=post-content><p>Recently, I enjoy using <code>Spacemacs</code>, so I decided to switch to org file from Markdown for writing blog. After several attempts, I managed to let Travis convert org file to HTML. Here are the steps.</p><h2 id=install-org-mode-plugin>Install Org Mode plugin
<a class=heading-link href=#install-org-mode-plugin><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>First you need to install Org Mode plugin on your computer following the official guide: <a href=https://plugins.getnikola.com/v8/orgmode/ class=external-link target=_blank rel=noopener>Nikola orgmode plugin</a>.</p><h2 id=edit-conf-dot-el>Edit <code>conf.el</code>
<a class=heading-link href=#edit-conf-dot-el><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p><code>Org Mode</code> will convert to HTML to display on Nikola. Org Mode plugin will call Emacs to do this job. When I run <code>nikola build</code>, it shows this message: <code>Please install htmlize from https://github.com/hniksic/emacs-htmlize</code>. I&rsquo;m using <code>Spacemacs</code>, the <code>htmlize</code> package is already downloaded if the <code>org</code> layer is enabled. I just need to add htmlize folder to load-path. So here is the code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elisp data-lang=elisp><span style=display:flex><span>(setq dir <span style=color:#e6db74>&#34;~/.emacs.d/elpa/27.0/develop/&#34;</span>)
</span></span><span style=display:flex><span>(if(<span style=color:#a6e22e>file-directory-p</span> dir)
</span></span><span style=display:flex><span>    (let ((default-directory dir))
</span></span><span style=display:flex><span>      (normal-top-level-add-subdirs-to-load-path)))
</span></span><span style=display:flex><span>(require <span style=color:#e6db74>&#39;htmlize</span>)
</span></span></code></pre></div><p>This package is also needed on Travis, the similar approach is required.</p><h2 id=modify-dot-travis-dot-yml>Modify <code>.travis.yml</code>
<a class=heading-link href=#modify-dot-travis-dot-yml><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Travis is using ubuntu 14.04, and the default Emacs version is 24, and the Org Mode version is below 8.0, which not match the requirements. The easiest solution is to update Emacs to 25. So in the <code>before_install</code> section, add these code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#ae81ff>sudo add-apt-repository ppa:kelleyk/emacs -y</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>sudo apt-get update</span>
</span></span></code></pre></div><p>In the <code>install</code> section, add these code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#ae81ff>sudo apt-get remove emacs</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>sudo apt autoremove</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>sudo apt-get install emacs25</span>
</span></span></code></pre></div><p>The default emacs doesn&rsquo;t contains <code>htmlize</code> package. So add <code>git clone https://github.com/hniksic/emacs-htmlize ~/emacs-htmlize</code> into <code>before_install</code> section.</p><p>Finally, modify <code>conf.el</code> for Travis Emacs, add GitHub repo to <code>load-path</code>: <code>(add-to-list 'load-path "~/emacs-htmlize/")</code></p><p>Voila, the org file should show up.</p><p>The full <code>.travis.yml</code> is below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>language</span>: <span style=color:#ae81ff>python</span>
</span></span><span style=display:flex><span><span style=color:#f92672>cache</span>: <span style=color:#ae81ff>apt</span>
</span></span><span style=display:flex><span><span style=color:#f92672>sudo</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span><span style=color:#f92672>addons</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>apt</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>packages</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>language-pack-en-base</span>
</span></span><span style=display:flex><span><span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>only</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>src</span>
</span></span><span style=display:flex><span><span style=color:#f92672>python</span>:
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>3.6</span>
</span></span><span style=display:flex><span><span style=color:#f92672>before_install</span>:
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>sudo add-apt-repository ppa:kelleyk/emacs -y</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>sudo apt-get update</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>openssl aes-256-cbc -K $encrypted_a5c638e4bedc_key -iv $encrypted_a5c638e4bedc_iv</span>
</span></span><span style=display:flex><span>  -<span style=color:#ae81ff>in travis.enc -out travis -d</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>git config --global user.name &#39;bebound&#39;</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>git config --global user.email &#39;bebound@gmail.com&#39;</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>git config --global push.default &#39;simple&#39;</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>pip install --upgrade pip wheel</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>echo -e &#39;Host github.com\n    StrictHostKeyChecking no&#39; &gt;&gt; ~/.ssh/config</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>eval &#34;$(ssh-agent -s)&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>chmod 600 travis</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>ssh-add travis</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>git remote rm origin</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>git remote add origin git@github.com:bebound/bebound.github.io</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>git fetch origin master</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>git branch master FETCH_HEAD</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>git clone https://github.com/hniksic/emacs-htmlize ~/emacs-htmlize</span>
</span></span><span style=display:flex><span><span style=color:#f92672>install</span>:
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>pip install &#39;Nikola[extras]&#39;==7.8.15</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>sudo apt-get remove emacs</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>sudo apt autoremove</span>
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>sudo apt-get install emacs25</span>
</span></span><span style=display:flex><span><span style=color:#f92672>script</span>:
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>nikola build &amp;&amp; nikola github_deploy -m &#39;Nikola auto deploy [ci skip]&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>notifications</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>email</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>on_success</span>: <span style=color:#ae81ff>change</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>on_failure</span>: <span style=color:#ae81ff>always</span>
</span></span></code></pre></div><p>And here is the <code>conf.el</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elisp data-lang=elisp><span style=display:flex><span>(setq dir <span style=color:#e6db74>&#34;~/.emacs.d/elpa/27.0/develop/&#34;</span>)
</span></span><span style=display:flex><span>(if(<span style=color:#a6e22e>file-directory-p</span> dir)
</span></span><span style=display:flex><span>    (let ((default-directory dir))
</span></span><span style=display:flex><span>      (normal-top-level-add-subdirs-to-load-path)))
</span></span><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;load-path</span> <span style=color:#e6db74>&#34;~/emacs-htmlize/&#34;</span>)
</span></span><span style=display:flex><span>(require <span style=color:#e6db74>&#39;htmlize</span>)
</span></span></code></pre></div></div><footer><div class=comments><script>let getTheme=window.localStorage&&window.localStorage.getItem("colorscheme"),themeInParams="preferred-color-scheme";getTheme==null&&(themeInParams!==""&&themeInParams!=="auto"?getTheme=themeInParams:getTheme=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");let theme=getTheme==="dark"?"github-dark":"github-light",s=document.createElement("script");s.src="https://utteranc.es/client.js",s.setAttribute("repo","bebound/bebound.github.io"),s.setAttribute("issue-term","pathname"),s.setAttribute("theme",theme),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></footer></article><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css integrity=sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0 crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js integrity=sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})'></script></section></div><footer class=footer><section class=container>©
2023
KK
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=https://www.fromkk.com/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-153788833-1","auto"),ga("send","pageview"))</script></body></html>