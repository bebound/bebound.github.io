<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Spark on KK's Blog (fromkk)</title><link>https://fromkk.com/tags/spark/</link><description>Recent content in Spark on KK's Blog (fromkk)</description><generator>Hugo</generator><language>en</language><lastBuildDate>Mon, 18 Dec 2023 21:38:38 +0800</lastBuildDate><atom:link href="https://fromkk.com/tags/spark/index.xml" rel="self" type="application/rss+xml"/><item><title>Dynamic Allocate Executors when Executing Jobs in Spark</title><link>https://fromkk.com/posts/dynamic-allocate-executors-when-executing-jobs-in-spark/</link><pubDate>Sun, 18 Jul 2021 16:52:00 +0800</pubDate><guid>https://fromkk.com/posts/dynamic-allocate-executors-when-executing-jobs-in-spark/</guid><description>&lt;p>I wrote a Spark program to process logs. The number of logs always changes as time goes by. To ensure logs can be processed instantly, the number of executors is calculated by the maximum of logs per minutes. As a consequence, the CPU usage is low in executors. In order to decrease resource waste, I tried to find a way to schedule executors during the execution of program.&lt;/p></description></item><item><title>Program Crash Caused by CPU Instruction</title><link>https://fromkk.com/posts/program-crash-caused-by-cpu-instruction/</link><pubDate>Sun, 17 May 2020 17:36:00 +0800</pubDate><guid>https://fromkk.com/posts/program-crash-caused-by-cpu-instruction/</guid><description>&lt;p>It&amp;rsquo;s inevitable to dealing with bugs in coding career. The main part of coding are implementing new features, fixing bugs and improving performance. For me, there are two kinds of bugs that is difficult to tackle: those are hard to reproduce, and those occur in code not wrote by you.&lt;/p></description></item><item><title>Import custom package or module in PySpark</title><link>https://fromkk.com/posts/import-custom-package-or-module-in-pyspark/</link><pubDate>Thu, 02 Apr 2020 22:24:00 +0800</pubDate><guid>https://fromkk.com/posts/import-custom-package-or-module-in-pyspark/</guid><description>&lt;p>First zip all of the dependencies into zip file like this. Then you can use one of the following methods to import it.&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-nil" data-lang="nil">|-- kk.zip
| |-- kk.py
&lt;/code>&lt;/pre>&lt;h2 id="using-py-files-in-spark-submit" class="relative group">Using &amp;ndash;py-files in spark-submit &lt;span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100">&lt;a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#using-py-files-in-spark-submit" aria-label="Anchor">#&lt;/a>&lt;/span>&lt;/h2>&lt;p>When submit spark job, add &lt;code>--py-files=kk.zip&lt;/code> parameter. &lt;code>kk.zip&lt;/code> will be distributed with the main scrip file, and &lt;code>kk.zip&lt;/code> will be inserted at the beginning of &lt;code>PATH&lt;/code> environment variable.&lt;/p></description></item></channel></rss>